<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Imports -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>

    <link rel="stylesheet" href="/main.css">
    <link rel="icon" href="/img/tophat-eevee.ico">
	
    <title> Eevil Chess Homepage </title>
    <style>
    </style>
  </head>
  
  <body>
    <div class="container">
      <!-- Header -->
      <div class="row" id="head">
        <table>
          <tr>
            <td id="logo"> <img src="/img/tophat-eevee.gif" /> </td>
            <td id="title"><h1> Eevil Chess </h1></td>
          </tr>
        </table>
      </div>

      <!-- Navigation bar -->
      <nav class="row navbar navbar-expand-lg navbar-light">
        <div class="navbar-nav">
          <ul>
            <li><a class="nav-item nav-link" href="./index.html"> Home </a></li>
            <li><a class="nav-item nav-link" href="./create-account.html"> Create Account </a></li>
            <li><a class="nav-item nav-link" href="./login.html">Login</a></li>
            <li><a class="nav-item nav-link" href="./profile.html">Profile</a></li>
            <li><a class="nav-item nav-link" href="./start-game.html">Start Game</a></li>
            <li><a class="nav-item nav-link active" href="./play-game.html">Play Game</a></li>
          </ul>
          <br style="clear:both;" />
        </div>
      </nav>

      <div class="board">
        <div v-for="col in cols + 1"></div>
        <template v-for="row in rows">
          <row :rowcode="row"></row>
          <tile v-for="col in cols" :colorcode=getColor(row,col) :tilecode="String.fromCharCode(col + 64) + row" :imgpath=getImage(row,col)></tile>
        </template>
        <div></div>
        <col-labels v-for="col in cols" :colcode="String.fromCharCode(col + 64)"></col-labels>

      </div>

      <!-- Footer -->
      <div class="row" id="footer">
        &copy Team Eevee <br />
        <i>Made for CSCI-4230: Software Engineering II </i>
      </div>
    </div>
  </body>
</html>

<script>

  function highlightPath(path) {
    console.log("In highlightPath")
    for(var i = 0; i < path.length; i++) {
      for(var j = 0; j < tileList.length; j++) {
        if(tileList[j].id === path[j]) {
          tileList[j].highlight = true;
        }   
      }
    }
  };
  function clearHighlights() {
    for(var i = 0; i < tileList.length; i++) {
      tileList[i].highlight = false;
    }
  }
  var tileList = [
        { id: "A1", occupied: { piece: "/img/black_bishop.png", paths: ["A1", "A2", "A3"] }, highlight: false},
        { id: "A2", occupied: { piece: "/img/black_bishop.png", paths: [] }, highlight: false},
        { id: "A3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "A4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "A5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "A6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "A7", occupied: { piece: "/img/white_pawn.png", paths: [] }, highlight: false},
        { id: "A8", occupied: { piece: "/img/white_knight.png", paths: [] }, highlight: false},
        { id: "B1", occupied: { piece: "/img/black_rook.png", paths: [] }, highlight: false},
        { id: "B2", occupied: { piece: "/img/black_bishop.png", paths: [] }, highlight: false},
        { id: "B3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "B4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "B5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "B6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "B7", occupied: { piece: "/img/white_knight.png", paths: [] }, highlight: false},
        { id: "B8", occupied: { piece: "/img/white_queen.png", paths: [] }, highlight: false},
        { id: "C1", occupied: { piece: "/img/black_queen.png", paths: [] }, highlight: false},
        { id: "C2", occupied: { piece: "/img/black_pawn.png", paths: [] }, highlight: false},
        { id: "C3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "C4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "C5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "C6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "C7", occupied: { piece: "/img/white_pawn.png", paths: [] }, highlight: false},
        { id: "C8", occupied: { piece: "/img/white_pawn.png", paths: [] }, highlight: false},
        { id: "D1", occupied: { piece: "/img/black_queen.png", paths: [] }, highlight: false},
        { id: "D2", occupied: { piece: "/img/black_bishop.png", paths: [] }, highlight: false},
        { id: "D3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "D4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "D5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "D6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "D7", occupied: { piece: "/img/white_bishop.png", paths: [] }, highlight: false},
        { id: "D8", occupied: { piece: "/img/white_king.png", paths: [] }, highlight: false},
        { id: "E1", occupied: { piece: "/img/black_king.png", paths: [] }, highlight: false},
        { id: "E2", occupied: { piece: "/img/black_knight.png", paths: [] }, highlight: false},
        { id: "E3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "E4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "E5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "E6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "E7", occupied: { piece: "/img/white_queen.png", paths: [] }, highlight: false},
        { id: "E8", occupied: { piece: "/img/white_queen.png", paths: [] }, highlight: false},
        { id: "F1", occupied: { piece: "/img/black_knight.png", paths: [] }, highlight: false},
        { id: "F2", occupied: { piece: "/img/black_pawn.png", paths: [] }, highlight: false},
        { id: "F3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "F4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "F5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "F6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "F7", occupied: { piece: "/img/white_knight.png", paths: [] }, highlight: false},
        { id: "F8", occupied: { piece: "/img/white_rook.png", paths: [] }, highlight: false},
        { id: "G1", occupied: { piece: "/img/black_rook.png", paths: [] }, highlight: false},
        { id: "G2", occupied: { piece: "/img/black_pawn.png", paths: [] }, highlight: false},
        { id: "G3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "G4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "G5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "G6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "G7", occupied: { piece: "/img/white_knight.png", paths: [] }, highlight: false},
        { id: "G8", occupied: { piece: "/img/white_rook.png", paths: [] }, highlight: false},
        { id: "H1", occupied: { piece: "/img/black_pawn.png", paths: [] }, highlight: false},
        { id: "H2", occupied: { piece: "/img/black_knight.png", paths: [] }, highlight: false},
        { id: "H3", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "H4", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "H5", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "H6", occupied: { piece: "", paths: [] }, highlight: false},
        { id: "H7", occupied: { piece: "/img/white_pawn.png", paths: [] }, highlight: false},
        { id: "H8", occupied: { piece: "/img/white_queen.png", paths: [] }, highlight: false},
      ];
  Vue.component('tile', {
    props: ['tilecode', 'colorcode', 'imgpath'],
    methods: {
      setColor(colorcode) {
        if(typeof colorcode === "string") {
          return colorcode;
        }
        else if(colorcode % 2 === 0) {
          return "tile2";
        } else {
          return "tile1";
        }
      },
      setID(tilecode) {
        return this.tilecode;
      },
      
      handleTileClick(tilecode) {
        for(var i = 0; i < tileList.length; i++) {
          if(tileList[i].id === tilecode) {
            if(!tileList[i].highlight) {
              clearHighlights();
              highlightPath(tileList[i].occupied.paths);
            }
            
          }
        }
      },
    },
    template: '<div  :class=setColor(colorcode) :id=setID(tilecode) @click=handleTileClick(tilecode)><img :src=imgpath class="center"></div>'
  });

  Vue.component('row', {
    props: ['rowcode'],
    methods: {

    },
    template: '<div>{{rowcode}}</div>'
  });

  Vue.component('col-labels', {
    props: ['colcode'],
    methods: {

    },
    template: '<div>{{ colcode }}</div>'
  });

  var app = new Vue({
    el: ".board",
    data: {
      rows: 8,
      cols: 8,
      tiles: tileList,
    },
    methods: {
      getImage(row, col) {
        var tilecode = String.fromCharCode(col + 64) + row;
        for(var i = 0; i < this.tiles.length; i++) {
          if(this.tiles[i].id === tilecode) {
            return this.tiles[i].occupied.piece;
          }
        }
        return "";
      },
      getColor(row, col) {
        var tilecode = String.fromCharCode(col + 64) + row;
        for(var i = 0; i < this.tiles.length; i++) {
          if(this.tiles[i].id === tilecode) {
            if(this.tiles[i].highlight === false) {
              return row % 2 === 0 ? col % 2 + 1 : (col + 1) % 2 + 1;
            } else {
              return "highlight";
            }
          } 
        }
      },
    }
  });


</script>

<style scoped>
  .board {
    margin: 0 auto;
    width: 500px;
    display: grid;
    grid-template-columns: repeat(9, 1fr);
    grid-auto-rows: minmax(50px, auto);
  }

  .tile1 {
    border: 1px solid #333;
    background-color: #666666;
  }

  .tile2 {
    border: 1px solid #333;
    background-color: #337298;
  }

  .center {
    display: block;
    width: 50px;
    height: 50px;
    margin: 0 auto;
  }

  .highlight {
    border: 1px solid #333;
    background-color: green;
  }
</style>
